{
    "contents" : "#Add Archteypes\n\ncombined_2013 <- readRDS(\"data/combined_2013_base.Rds\")\n\n###########################################################################\n#Construct Energy Architypes\n############################################################################\n\n#sel <- combined_2013[,c(\"aacode\",\"aagpd1213\",\"Finchtyp\",\"mainfuel\",\"watersys\",\"tank\",\"Finmhboi\")]\n#sel <- sel[with(sel, order(Finchtyp,mainfuel,watersys,tank,Finmhboi)),]\n#uni <- unique(sel[,c(\"Finchtyp\",\"mainfuel\",\"watersys\",\"tank\",\"Finmhboi\")])\n\n#uni$count <- NA\n#uni$countsamp <- NA\n#uni$conf <- NA\n#for (f in 1:nrow(uni)){\n#  uni$count[f] <- sum(sel$aagpd1213[sel$Finchtyp == uni$Finchtyp[f] & sel$mainfuel == uni$mainfuel[f] & sel$watersys == uni$watersys[f] & sel$tank == uni$tank[f] & sel$Finmhboi == uni$Finmhboi[f] ])\n#  uni$countsamp[f] <- nrow(sel[sel$Finchtyp == uni$Finchtyp[f] & sel$mainfuel == uni$mainfuel[f] & sel$watersys == uni$watersys[f] & sel$tank == uni$tank[f] & sel$Finmhboi == uni$Finmhboi[f], ])\n#  uni$conf[f] <- uni$count[f] / uni$countsamp[f]\n#}\n\n#write.csv(uni,\"data/energy_archetype_13.csv\")\n\n\n###########################################################################\n#Construct General Architypes - Version 1\n############################################################################\n\n#sel <- combined_2013[,c(\"aacode\",\"aagpd1213\",\"type\",\"dwage9x\")]\n#sel <- sel[with(sel, order(type,dwage9x)),]\n#uni <- unique(sel[,c(\"type\",\"dwage9x\")])\n\n#uni$count <- NA\n#uni$countsamp <- NA\n#uni$conf <- NA\n#for (f in 1:nrow(uni)){\n#  uni$count[f] <- sum(sel$aagpd1213[sel$type == uni$type[f]  & sel$dwage9x == uni$dwage9x[f] ])\n#  uni$countsamp[f] <- nrow(sel[sel$type == uni$type[f]  & sel$dwage9x == uni$dwage9x[f] , ])\n#  uni$conf[f] <- uni$count[f] / uni$countsamp[f]\n#}\n\n#write.csv(uni,\"data/general_architype_2013.csv\")\n\n\n###########################################################################\n#Construct General Architypes - Other Version\n############################################################################\n\n#sel <- combined_2013[,c(\"aacode\",\"aagpd1213\",\"dwtypenx\",\"dwage9x\")]\n#sel <- sel[with(sel, order(dwtypenx,aagpd1213,dwage9x)),]\n#uni <- unique(sel[,c(\"dwtypenx\",\"dwage9x\")])\n\n#uni$count <- NA\n#uni$countsamp <- NA\n#uni$conf <- NA\n#for (f in 1:nrow(uni)){\n#  uni$count[f] <- sum(sel$aagpd1213[sel$dwtypenx == uni$dwtypenx[f]  & sel$dwage9x == uni$dwage9x[f] ])\n#  uni$countsamp[f] <- nrow(sel[sel$dwtypenx == uni$dwtypenx[f]  & sel$dwage9x == uni$dwage9x[f] , ])\n#  uni$conf[f] <- uni$count[f] / uni$countsamp[f]\n#}\n\n#write.csv(uni,\"data/general_archetypes_13.csv\")\n\n\n###########################################################################\n#Construct Roof Architypes\n############################################################################\n\n#sel <- combined_2013[,c(\"aacode\",\"aagpd1213\",\"typerstr\",\"attic\",\"LoftIns\")]\n#sel <- sel[with(sel, order(typerstr,attic,LoftIns)),]\n#uni <- unique(sel[,c(\"typerstr\",\"attic\",\"LoftIns\")])\n\n#uni$count <- NA\n#uni$countsamp <- NA\n#uni$conf <- NA\n#for (f in 1:nrow(uni)){\n#  uni$count[f] <- sum(sel$aagpd1213[sel$typerstr == uni$typerstr[f] & sel$attic == uni$attic[f]  & sel$LoftIns == uni$LoftIns[f]  ])\n#  uni$countsamp[f] <- nrow(sel[sel$typerstr == uni$typerstr[f] & sel$attic == uni$attic[f]  & sel$LoftIns == uni$LoftIns[f] , ])\n#  uni$conf[f] <- uni$count[f] / uni$countsamp[f]\n#}\n\n#write.csv(uni,\"data/roof_archetypes_13.csv\")\n\n\n###########################################################################\n#Construct Solar Architypes\n############################################################################\n\n#sel <- combined_2013[,c(\"aacode\",\"aagpd1213\",\"SolarSuit\",\"PV\",\"Solar\")]\n#sel <- sel[with(sel, order(SolarSuit,PV,Solar)),]\n#uni <- unique(sel[,c(\"SolarSuit\",\"PV\",\"Solar\")])\n\n#uni$count <- NA\n#uni$countsamp <- NA\n#uni$conf <- NA\n#for (f in 1:nrow(uni)){\n#  uni$count[f] <- sum(sel$aagpd1213[sel$SolarSuit == uni$SolarSuit[f] & sel$PV == uni$PV[f] & sel$Solar == uni$Solar[f]  ])\n#  uni$countsamp[f] <- nrow(sel[sel$SolarSuit == uni$SolarSuit[f] & sel$PV == uni$PV[f] & sel$Solar == uni$Solar[f] , ])\n#  uni$conf[f] <- uni$count[f] / uni$countsamp[f]\n#}\n\n#write.csv(uni,\"data/solar_archetypes_13.csv\")\n\n\n###########################################################################\n#Construct Wall Architypes\n############################################################################\n\n#sel <- combined_2013[,c(\"aacode\",\"aagpd1213\",\"typewstr2\",\"wallinsy\")]\n#sel <- sel[with(sel, order(typewstr2,wallinsy)),]\n#uni <- as.data.frame(unique(sel[,c(\"typewstr2\",\"wallinsy\")]))\n#names(uni) <- \"typewstr2\"\n\n#uni$count <- NA\n#uni$countsamp <- NA\n#uni$conf <- NA\n#for (f in 1:nrow(uni)){\n#  uni$count[f] <- sum(sel$aagpd1213[sel$typewstr2 == uni$typewstr2[f] &  sel$wallinsy == uni$wallinsy[f] ])\n#  uni$countsamp[f] <- nrow(sel[sel$typewstr2 == uni$typewstr2[f] &  sel$wallinsy == uni$wallinsy[f] , ])\n#  uni$conf[f] <- uni$count[f] / uni$countsamp[f]\n#}\n\n#write.csv(uni,\"data/wall_archetypes_13.csv\")\n\n\n\n#Asign Energy Architype\nenergy_arch <- read.csv(\"data/energy_archetype_13.csv\", stringsAsFactors = FALSE)\n\ncombined_2013$energytyp <- NA\ncombined_2013$Finchtyp <- as.character(combined_2013$Finchtyp)\ncombined_2013$mainfuel <- as.character(combined_2013$mainfuel)\ncombined_2013$watersys <- as.character(combined_2013$watersys)\ncombined_2013$tank <- as.character(combined_2013$tank)\n\nfor(h in 1:nrow(combined_2013)){\n  combined_2013$energytyp[h] <- energy_arch$EnergyType[energy_arch$Finchtyp == combined_2013$Finchtyp[h] & energy_arch$mainfuel == combined_2013$mainfuel[h] & energy_arch$watersys == combined_2013$watersys[h] & energy_arch$tank == combined_2013$tank[h] & energy_arch$Finmhboi == combined_2013$Finmhboi[h]]\n}\n\ncombined_2013$energytyp <- as.factor(combined_2013$energytyp)\nsummary(combined_2013$energytyp)\n\n#General Architype\ngeneral_arch <- read.csv(\"data/general_archetypes_13.csv\", stringsAsFactors = FALSE)\n\ncombined_2013$generaltyp <- NA\ncombined_2013$type <- as.character(combined_2013$type)\ncombined_2013$dwage9x <- as.character(combined_2013$dwage9x)\ncombined_2013$dwtypenx <- as.character(combined_2013$dwtypenx)\n\n#for(i in 1:nrow(combined_2013)){\n#  combined_2013$generaltyp[i] <- general_arch$GeneralType[general_arch$type == combined_2013$type[i] & general_arch$dwage9x == combined_2013$dwage9x[i] ]\n#}\n\nfor(i in 1:nrow(combined_2013)){\n combined_2013$generaltyp[i] <- general_arch$GeneralType[general_arch$dwtypenx == combined_2013$dwtypenx[i] & general_arch$dwage9x == combined_2013$dwage9x[i] ]\n}\n\ncombined_2013$generaltyp <- as.factor(combined_2013$generaltyp)\nsummary(combined_2013$generaltyp)\n\n#Roof Architype\nroof_arch <- read.csv(\"data/roof_archetypes_13.csv\", stringsAsFactors = FALSE)\n\ncombined_2013$rooftyp <- NA\ncombined_2013$typerstr <- as.character(combined_2013$typerstr)\ncombined_2013$attic <- as.character(combined_2013$attic)\ncombined_2013$LoftIns <- as.character(combined_2013$LoftIns)\n\nfor(i in 1:nrow(combined_2013)){\n  combined_2013$rooftyp[i] <- roof_arch$RoofType[roof_arch$typerstr == combined_2013$typerstr[i] & roof_arch$attic == combined_2013$attic[i] & roof_arch$LoftIns == combined_2013$LoftIns[i]]\n}\n\ncombined_2013$rooftyp <- as.factor(combined_2013$rooftyp)\nsummary(combined_2013$rooftyp)\n\n#Solar Architype\nsolar_arch <- read.csv(\"data/solar_archetypes_13.csv\", stringsAsFactors = FALSE)\n\ncombined_2013$solartyp <- NA\ncombined_2013$SolarSuit <- as.character(combined_2013$SolarSuit)\ncombined_2013$PV <- as.character(combined_2013$PV)\ncombined_2013$Solar <- as.character(combined_2013$Solar)\n\nfor(i in 1:nrow(combined_2013)){\n  combined_2013$solartyp[i] <- solar_arch$SolarType[solar_arch$SolarSuit == combined_2013$SolarSuit[i] & solar_arch$PV == combined_2013$PV[i] & solar_arch$Solar == combined_2013$Solar[i] ]\n}\n\ncombined_2013$solartyp <- as.factor(combined_2013$solartyp)\nsummary(combined_2013$solartyp)\n\n#Wall Architype\nwall_arch <- read.csv(\"data/wall_archetypes_13.csv\", stringsAsFactors = FALSE)\n\ncombined_2013$walltyp <- NA\ncombined_2013$typewstr2 <- as.character(combined_2013$typewstr2)\ncombined_2013$wallinsy <- as.character(combined_2013$wallinsy)\n\n\nfor(i in 1:nrow(combined_2013)){\n  combined_2013$walltyp[i] <- wall_arch$WallType[wall_arch$typewstr2 == combined_2013$typewstr2[i] & wall_arch$wallinsy == combined_2013$wallinsy[i] ]\n}\n\ncombined_2013$walltyp <- as.factor(combined_2013$walltyp)\nsummary(combined_2013$walltyp)\n\n#Combine togther archetypes\n#General-Energy-Wall-Roof-Solar\ncombined_2013$archcode <- paste0(combined_2013$generaltyp,\"-\",combined_2013$rooftyp,\"-\",combined_2013$walltyp,\"-\",combined_2013$energytyp,\"-\",combined_2013$solartyp)\n#combined_2013$archcode <- paste0(combined_2013$energytyp,\"-\",combined_2013$walltyp,\"-\",combined_2013$rooftyp,\"-\",combined_2013$solartyp)\nsel <- combined_2013[,c(\"aacode\",\"aagpd1213\",\"archcode\")]\nsel <- sel[with(sel, order(archcode)),]\nuni <- as.data.frame(unique(sel[,c(\"archcode\")]))\nnames(uni) <- \"archcode\"\n\nuni$count <- NA\nuni$countsamp <- NA\nuni$conf <- NA\nfor (f in 1:nrow(uni)){\n  uni$count[f] <- sum(sel$aagpd1213[sel$archcode == uni$archcode[f] ])\n  uni$countsamp[f] <- nrow(sel[sel$archcode == uni$archcode[f]  , ])\n  uni$conf[f] <- uni$count[f] / uni$countsamp[f]\n}\nnrow(uni)\n#Count of arch with only one sample\nsum(uni$count[uni$countsamp == 1])\nlength(uni$count[uni$countsamp == 1])\n#Coutn of arch with many samples\nsum(uni$count[uni$countsamp >= 10])\nlength(uni$count[uni$countsamp >= 10])\nplot(uni$count[order(-uni$count)])\n\nsel <- uni[uni$countsamp >= 10,]\nsel <- sel[sel$count >= 10000,]\nplot(sel$count[order(-sel$count)])\nsum(sel$count)\n\n\nsaveRDS(combined_2013,\"data/combined_2013_arch.Rds\")\n",
    "created" : 1492528813264.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2258504432",
    "id" : "BCC683FA",
    "lastKnownWriteTime" : 1492523526,
    "path" : "C:/Users/earmmor/Git/glider/Glider/code/add_archetypes.R",
    "project_path" : "code/add_archetypes.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}