{
    "contents" : "#Read in EHS and convert to RDS\nlibrary(foreign)\nlibrary(dplyr, lib.loc = \"M:/R/R-3.3.1/library\")\nlibrary(lazyeval, lib.loc = \"M:/R/R-3.3.1/library\")\ncurrent_year <- 2009\n\n\ninfld <- \"C:/Users/earmmor/OneDrive/OD/Glider - Private/WP2/Data/EHS/EHS-2009-SPSS/UKDA-6804-spss/spss/spss19/\"\n###############################################################################\n#Physical Table - only partical match\n##############################################################################\nphysical3 <- read.spss(paste0(infld,\"derived/physical_08_09.sav\"),to.data.frame=TRUE)\nphysical3 <- physical3[,c(\"aacode\",\"dwtypenx\",\"dwage9x\",\"floorx\",\"floor5x\",\"storeyx\",\"typerstr\",\n                        \"typewstr\",\"typewfin\",\"typewin\",\"dblglaz4\",\"arnatx\",\"attic\",\n                        \"basement\",\"heat7x\",\"sysage\",\"mainfuel\",\"watersys\",\"boiler\",\n                        \"sap12\")]\n#############################################################################\n#General Table - match when fixing names\n###########################################################################\ngeneral3 <- read.spss(paste0(infld,\"derived/general_08_09.sav\"),to.data.frame=TRUE)\ngeneral3 <- general3[,c(\"aacode\",\"tenure4x\",\"vacantx\",\"gorEHCS\",\"rumorph\",\"imd\")]\nnames(general3) <- c(\"aacode\",\"tenure4x\",\"vacantx\",\"GorEHCS\",\"rumorph\",\"imd\")\n\n##########################################################################\n#elevate Table - match\n####################################################################\nelevate3 <- read.spss(paste0(infld,\"physical/elevate.sav\"),to.data.frame=TRUE)\nelevate3 <- elevate3[,c( \"aacode\",\"Felsolff\",\"Felcavff\",\"Felextff\",\n                                \"Felsollf\",\"Felcavlf\",\"Felextlf\",\n                                \"Felsolrf\",\"Felcavrf\",\"Felextrf\",\n                                \"Felsolbf\",\"Felcavbf\",\"Felextbf\")]\n\n#\"Felpvff\"\n#\"Felpvlf\"\n#\"Felpvrf\"\n#\"Felpvbf\"\n#\"felroofp\"\n#\"Fvwpvbf\"\n#\"Fvwpvlf\"\n#\"Fvwpvrf\"\n#\"Fvwpvff\"\n\n\n\n############################################################################\n#Services Table - match\n############################################################################\nservices3 <- read.spss(paste0(infld,\"physical/services.sav\"),to.data.frame=TRUE)\nservices3 <- services3[,c(\"aacode\",\"Finchtyp\",\"Finmhfue\",\"Finmhboi\",\"Finchbag\",\n                        \"Finchoff\",\"Finchthe\",\"Finchtim\",\"Finchove\",\"Finchrom\",\"Finchcon\",\"Finchtrv\",\"Finchtzc\",\"Finchdst\",\n                        \"Finoheat\",\"Finohphs\",\"Finohtyp\",\n                        \"Finwheat\", \"Finwhoty\",\"Finwhoac\",\"Finwhoag\",\"Finwhxpr\",\"Finwhxty\",\"Finwhxag\",\n                        \"Finwsipr\",\"Finwsiag\",\"Finwdipr\",\"Finwdiag\",\n                        \"Finwsppr\",\"Finwspty\",\"Finwspag\",\n                        \"Finwmppr\",\"Finwmpty\",\"Finwmpag\",\n                        \"Finwhlpr\",\"Finwhlty\",\"Finwhlag\",\n                        \"Finwhcyl\",\"Finwhsiz\",\"Finwhins\",\"Finwhmms\",\n                        \"Finwhcen\",\"Finwhthe\",\"Finlopos\",\"Flitypes\",\"Fliinsul\",\"Finintyp\",\"Flithick\")]\n#########################################################################\n#Combine\n########################################################################\ncombined <- left_join(physical,general, by = \"aacode\")\ncombined <- left_join(combined,services, by = \"aacode\")\ncombined <- left_join(combined,elevate, by = \"aacode\")\nremove(physical,general,services,elevate)\n\n#######################################################################\n#roof table\n########################################################################\nroof <- combined[,c(\"aacode\",\"typerstr\",\"Flitypes\",\"Fliinsul\",\"Finintyp\",\"Flithick\",\"attic\",\n                    \"Felsolff\",\"Felpvff\",\n                    \"Felsollf\",\"Felpvlf\",\n                    \"Felsolrf\",\"Felpvrf\",\n                    \"Felsolbf\",\"Felpvbf\",\n                    \"felroofp\",\"Fvwpvbf\",\"Fvwpvlf\",\"Fvwpvrf\",\"Fvwpvff\")]\n\n#Remove NAs\nrem_na <- function(col){\n  for(x in 1:length(col)){\n    if(is.na(col[x])){\n      col[x]<- \"No\"\n    }\n  } \n  return(col)\n}\n\nroof$Felpvff <- rem_na(roof$Felpvff)\nroof$Felpvbf <- rem_na(roof$Felpvbf)\nroof$Felpvlf <- rem_na(roof$Felpvlf)\nroof$Felpvrf <- rem_na(roof$Felpvrf)\nroof$Felsolff <- rem_na(roof$Felsolff)\nroof$Felsolbf <- rem_na(roof$Felsolbf)\nroof$Felsollf <- rem_na(roof$Felsollf)\nroof$Felsolrf <- rem_na(roof$Felsolrf)\nroof$Fvwpvff <- rem_na(roof$Fvwpvff)\nroof$Fvwpvbf <- rem_na(roof$Fvwpvbf)\nroof$Fvwpvlf <- rem_na(roof$Fvwpvlf)\nroof$Fvwpvrf <- rem_na(roof$Fvwpvrf)\n\n#Summarise PV\nroof$PV <- NA\nfor(i in 1:nrow(roof)){\n  if((roof$Felpvff[i] == \"Yes\") || (roof$Felpvbf[i] == \"Yes\") || (roof$Felpvlf[i] == \"Yes\") || (roof$Felpvrf[i] == \"Yes\")){\n    roof$PV[i] <- TRUE\n  }else{\n    roof$PV[i] <- FALSE\n    }\n}\n\n#Summarise Solar\nroof$Solar <- NA\nfor(j in 1:nrow(roof)){\n  if((roof$Felsolff[j] == \"Yes\") || (roof$Felsolbf[j] == \"Yes\") || (roof$Felsollf[j] == \"Yes\") || (roof$Felsolrf[j] == \"Yes\")){\n    roof$Solar[j] <- TRUE\n  }else{\n    roof$Solar[j] <- FALSE\n  }\n}\n\n#Summarise Suitability\nroof$SolarSuit <- NA\nfor(k in 1:nrow(roof)){\n  if((roof$Fvwpvff[k] == \"Yes\") || (roof$Fvwpvbf[k] == \"Yes\") || (roof$Fvwpvlf[k] == \"Yes\") || (roof$Fvwpvrf[k] == \"Yes\")){\n    roof$SolarSuit [k] <- TRUE\n  }else{\n    roof$SolarSuit [k] <- FALSE\n  }\n}\n\nroof <- roof[,c(\"aacode\",\"typerstr\",\"Flitypes\",\"Fliinsul\",\"Finintyp\",\"Flithick\",\"felroofp\",\"attic\",\"PV\",\"Solar\",\"SolarSuit\")]\n\n##########################################################################\n#Walls Table\n###########################################################################\nwalls <- combined[,c(\"aacode\",\"typewstr2\",\"constx\",\"typewfin\",\"wallinsy\",\"wallcavy\")]\n\n#Plot\ncounts <- table(walls$wallinsy)\nbarplot(counts, main=\"External Wall Insualtion\", ylab=\"Number of Dwellings\")\n\n############################################################################################\n#Shape Table\n###########################################################################################\nshape <- combined[,c(\"aacode\",\"dwtypenx\",\"dwage9x\",\"floorx\",\"floor5x\",\"storeyx\",\"basement\",\"Finlopos\")]\nshape$type <- as.factor(paste0(shape$Finlopos,\" \",shape$dwtypenx))\nsummary(shape$type)\n\n#Plot\ncounts <- table(shape$type)\nbarplot(counts, main=\"Building Type\", ylab=\"Number of Dwellings\",las=2)\n\n\n#Create an exact age\nshape$age <- NA\nfor(r in 1:nrow(shape)){\n  if(shape$dwage9x[r] == \"pre 1850\"){\n    shape$age[r] <- 1849\n  }else if (shape$dwage9x[r] == \"1850 to 1899\"){\n    shape$age[r] <- sample(1850:1899, 1)\n  }else if (shape$dwage9x[r] == \"1900 to 1918\"){\n    shape$age[r] <- sample(1900:1918, 1)\n  }else if (shape$dwage9x[r] == \"1919 to 1944\"){\n    shape$age[r] <- sample(1919:1944, 1)\n  }else if (shape$dwage9x[r] == \"1945 to 1964\"){\n    shape$age[r] <- sample(1945:1964, 1)\n  }else if (shape$dwage9x[r] == \"1965 to 1974\"){\n    shape$age[r] <- sample(1965:1974, 1)\n  }else if (shape$dwage9x[r] == \"1975 to 1980\"){\n    shape$age[r] <- sample(1975:1980, 1)\n  }else if (shape$dwage9x[r] == \"1981 to 1990\"){\n    shape$age[r] <- sample(1981:1990, 1)\n  }else if (shape$dwage9x[r] == \"post 1990\"){\n    shape$age[r] <- sample(1990:2013, 1)\n  }else {\n    shape$age[r] <- 0\n  }\n}\n\n#Remove Unneeded Columns\nrems <- !names(shape) %in% c(\"Finlopos\",\"dwtypenx\",\"floorx\",\"dwage9x\")\nshape <- shape[,rems]\n\n############################################################################\n#Context Table\n###########################################################################\ncontext <- combined[c(\"aacode\",\"tenure4x\",\"vacantx\",\"GorEHCS\",\"rumorph\",\"rucombin\",\"imd1010\",\"arnatx\")]\n\n\n\n#########################################################################\n#Energy Table\n##########################################################################\nenergy <- combined[c(\"aacode\",\"Finchtyp\",\"Findisty\",\"mainfuel\",\"Finmhboi\",\"Finchbag\",\"heatsec\",\"sysage\",\"watersys\",\n                     \"Finchoff\",\"Finchthe\",\"Finchtim\",\"Finchove\",\"Finchrom\",\"Finchcon\",\"Finchtrv\",\"Finchtzc\",\"Finchdst\",\n                     \"Finohphs\",\n                     \"Finwheat\", \"Finwhoty\",\"Finwhoag\",\n                     \"Finwsipr\",\"Finwsiag\",\"Finwdipr\",\"Finwdiag\",\n                     \"Finwsppr\",\n                     \"Finwmppr\",\n                     \"Finwhlty\",\n                     \"Finwhcyl\",\"Finwhsiz\",\"Finwhins\",\"Finwhmms\"\n                     )]\n\n#Remove Nulls from Controls\n\nenergy$Finchoff <- rem_na(energy$Finchoff) #On/Off\nenergy$Finchtim <- rem_na(energy$Finchtim) #central timer\nenergy$Finchthe <- rem_na(energy$Finchthe) #Boiler Thermostat\nenergy$Finchove <- rem_na(energy$Finchove) #Manual Overide\nenergy$Finchrom <- rem_na(energy$Finchrom) #Room Thermostat\nenergy$Finchcon <- rem_na(energy$Finchcon) #Radiator Control\nenergy$Finchtrv <- rem_na(energy$Finchtrv) #Thermostatic Radiator Conrol\nenergy$Finchtzc <- rem_na(energy$Finchtzc) #Time and Temp Zone\nenergy$Finchdst <- rem_na(energy$Finchdst) #Delayed Start\n\nenergy$control <- NA\n\n# Energy Control Levle cumulative number of controls had\n#L7 - Delay Start, L6 - Time and temp zones, L5 - Room Thermostat, L4 - Boiler Thermostat, L3 - Manual Overide, L2 - Central Timer, L1 - On/Off, L0 - None, L9 - Other combination\n\nfor(l in 1:nrow(energy)){\n  if(energy$Finchtim[l] == \"Yes\" && energy$Finchdst[l] == \"Yes\" && energy$Finchtzc[l] == \"Yes\" && energy$Finchrom[l] == \"Yes\" && energy$Finchthe[l] == \"Yes\" && energy$Finchove[l] == \"Yes\" && energy$Finchoff[l] == \"Yes\"){\n    energy$control[l] <- 7\n  } else if (energy$Finchtim[l] == \"Yes\" && energy$Finchtzc[l] == \"Yes\" && energy$Finchrom[l] == \"Yes\" && energy$Finchthe[l] == \"Yes\" && energy$Finchove[l] == \"Yes\" && energy$Finchoff[l] == \"Yes\"){\n    energy$control[l] <- 6\n  } else if (energy$Finchtim[l] == \"Yes\" && energy$Finchrom[l] == \"Yes\" && energy$Finchthe[l] == \"Yes\" && energy$Finchove[l] == \"Yes\" && energy$Finchoff[l] == \"Yes\"){\n    energy$control[l] <- 5\n  } else if (energy$Finchtim[l] == \"Yes\" && energy$Finchthe[l] == \"Yes\" && energy$Finchove[l] == \"Yes\" && energy$Finchoff[l] == \"Yes\"){\n    energy$control[l] <- 4\n  } else if (energy$Finchtim[l] == \"Yes\" && energy$Finchove[l] == \"Yes\" && energy$Finchoff[l] == \"Yes\"){\n    energy$control[l] <- 3\n  } else if (energy$Finchtim[l] == \"Yes\" && energy$Finchoff[l] == \"Yes\"){\n    energy$control[l] <- 2\n  } else if (energy$Finchoff[l] == \"Yes\"){\n    energy$control[l] <- 1    \n  } else if (energy$Finchtim[l] == \"No\" && energy$Finchdst[l] == \"No\" && energy$Finchtzc[l] == \"No\" && energy$Finchrom[l] == \"No\" && energy$Finchthe[l] == \"No\" && energy$Finchove[l] == \"No\" && energy$Finchoff[l] == \"No\"){\n    energy$control[l] <- 0\n  } else {\n    energy$control[l] <- 9\n  }\n}\n\ncounts <- table(energy$control)\nbarplot(counts, main=\"Control Level\", ylab=\"Number of Dwellings\")\n\n#Radiator Control Level\n#L2 - TRVs, L1 - Controls, L0 - None\n\nenergy$radcontrol <- NA\nfor(m in 1:nrow(energy)){\n  if(energy$Finchtrv[m] == \"Yes\"){\n    energy$radcontrol[m] <- 2\n  } else if (energy$Finchtrv[m] == \"No\" && energy$Finchcon[m] == \"Yes\"){\n    energy$radcontrol[m] <- 1\n  } else {\n    energy$radcontrol[m] <- 0\n  }\n}\n\n#Plot\ncounts <- table(energy$radcontrol)\nbarplot(counts, main=\"Radiator Control Level\", ylab=\"Number of Dwellings\")\n\n\n#Remove Unneeded Columns\nrems <- !names(energy) %in% c(\"Finchtim\",\"Finchoff\",\"Finchthe\",\"Finchove\",\"Finchrom\",\"Finchcon\",\"Finchtrv\",\"Finchtzc\",\"Finchdst\")\nenergy <- energy[,rems]\n\n#Simplify Water Cylinder and Imersion Heater\n\nenergy$Finwsipr <- rem_na(energy$Finwsipr) #Single Immersion\nenergy$Finwdipr <- rem_na(energy$Finwdipr) #Dual Immersion\nenergy$Finwhcyl <- rem_na(energy$Finwhcyl) #Water Cyclinder\n\nenergy$tank <-NA\nenergy$immersage <- NA\nfor(n in 1:nrow(energy)){\n  if((energy$Finwsipr[n] == \"Yes\" || energy$Finwdipr[n] == \"Yes\") && energy$Finwhcyl[n] == \"Yes\"){\n    energy$tank[n] <- \"Tank with Immersion Heater\"\n    if(is.na(energy$Finwsiag[n])){\n      energy$immersage[n] <- energy$Finwdiag[n]\n    }else{\n      energy$immersage[n] <- energy$Finwsiag[n]\n    }\n  }else if((energy$Finwsipr[n] == \"No\" && energy$Finwdipr[n] == \"No\") && energy$Finwhcyl[n] == \"Yes\"){\n    energy$tank[n] <- \"Tank without Immersion Heater\"\n  }else{\n    energy$tank[n] <- \"No Tank\"\n  }\n}\n\n#Remove Unneeded Columns\nrems <- !names(energy) %in% c(\"Finwsipr\",\"Finwdipr\",\"Finwhcyl\",\"Finwdiag\",\"Finwsiag\")\nenergy <- energy[,rems]\n\n#Plot\ncounts <- table(energy$tank)\nbarplot(counts, main=\"Water Tank Type\", ylab=\"Number of Dwellings\")\n\n#Simplify Instaneous Heater\nenergy$Finwmppr <- rem_na(energy$Finwmppr) #Mulitpoint\nenergy$Finwsppr <- rem_na(energy$Finwsppr) #Single Point\n\nenergy$instant <- NA\nfor(o in 1:nrow(energy)){\n  if(energy$Finwmppr[o] == \"Yes\" && energy$Finwsppr[o] == \"Yes\"){\n    energy$instant[o] <- \"Yes\"\n  }else if(energy$Finwmppr[o] == \"No\" && energy$Finwsppr[o] == \"Yes\"){\n    energy$instant[o] <- \"Yes\"\n  }else if(energy$Finwmppr[o] == \"Yes\" && energy$Finwsppr[o] == \"No\"){\n    energy$instant[o] <- \"Yes\"\n  }else{\n    energy$instant[o] <- \"No\"\n  }\n}\n\n#Remove Unneeded Columns\nrems <- !names(energy) %in% c(\"Finwmppr\",\"Finwsppr\")\nenergy <- energy[,rems]\n\n#Plot\ncounts <- table(energy$instant)\nbarplot(counts, main=\"Instaneous Water Heater\", ylab=\"Number of Dwellings\")\n\n\nlevels(energy$Finchtyp) <- c(levels(energy$Finchtyp),\"No Answer\")\n\n#Clean Main ones\nfor(q in 1:nrow(energy)){\n  if(is.na(energy$Finmhboi[q])){\n    energy$Finmhboi[q] <- \"No boiler\"\n  }\n  if(is.na(energy$Finchtyp[q])){\n    energy$Finchtyp[q] <- \"No Answer\"\n  }\n  \n}\n\n\n#Mulit-row per dwelling tables\n######################################################################\n#Doors Table\n######################################################################\ndoors <- read.spss(paste0(infld,\"physical/doors.sav\"),to.data.frame=TRUE)\ndoors <- doors[,c(\"aacode\",\"type\",\"Fexdf1no\",\"Fexdf1ag\",\n                                  \"Fexdf2no\",\"Fexdf2ag\")]\ndoors <- doors[doors$Fexdf1no > 0 | doors$Fexdf2no > 0 ,]\ndoors$number <- doors$Fexdf1no + doors$Fexdf2no\nsummary((doors$Fexdf1ag != doors$Fexdf2ag) & (doors$Fexdf1no != 0 | doors$Fexdf2no != 0)) #2/3 have the same age front and back when accounting for only on front or back\n\n#Remove NAs\nrem_na_0 <- function(col){\n  for(x in 1:length(col)){\n    if(is.na(col[x])){\n      col[x]<- 0\n    }\n  } \n  return(col)\n}\ndoors$Fexdf1ag <- rem_na_0(doors$Fexdf1ag)\ndoors$Fexdf2ag <- rem_na_0(doors$Fexdf2ag)\ndoors$age <- pmax(doors$Fexdf1ag,doors$Fexdf2ag)\n\n#Remove Unneeded Columns\nrems <- !names(doors) %in% c(\"Fexdf1ag\",\"Fexdf2ag\",\"Fexdf1no\",\"Fexdf2no\")\ndoors <- doors[,rems]\ndoors <- reshape(doors, direction = \"wide\", idvar=\"aacode\", timevar=\"type\")\n\ndoors$number.Wood <- rem_na_0(doors$number.Wood)\ndoors$number.UPVC <- rem_na_0(doors$number.UPVC)\ndoors$number.Metal <- rem_na_0(doors$number.Metal)\ndoors$age.Wood <- rem_na_0(doors$age.Wood)\ndoors$age.UPVC <- rem_na_0(doors$age.UPVC)\ndoors$age.Metal <- rem_na_0(doors$age.Metal)\n\ndoors$doornumb <- doors$number.Wood + doors$number.UPVC + doors$number.Metal\ndoors$doorage <- pmax(doors$age.Wood, doors$age.UPVC, doors$age.Metal)\n\ndoors <- doors[,c(\"aacode\",\"doornumb\",\"doorage\")]\n\n################################################################################\n#Windows Table\n#############################################################################\nwindows <- read.spss(paste0(infld,\"physical/windows.sav\"),to.data.frame=TRUE)\nwindows <- windows[,c(\"aacode\",\"type\",\"Fexwn1no\",\"Fexwn1ag\",\n                                      \"Fexwn2no\",\"Fexwn2ag\")]\nwindows <- windows[windows$Fexwn1no > 0 | windows$Fexwn2no > 0,]\n\nwindows$numb <- windows$Fexwn1no + windows$Fexwn2no\nsummary((windows$Fexwn1ag != windows$Fexwn2ag) & (windows$Fexwn1no != 0 | windows$Fexwn2no != 0)) #2/3 have the same age front and back when accounting for only on front or back\n\nwindows$Fexwn1ag <- rem_na_0(windows$Fexwn1ag)\nwindows$Fexwn2ag <- rem_na_0(windows$Fexwn2ag)\nwindows$age <- pmax(windows$Fexwn1ag,windows$Fexwn2ag)\n\n#Remove Unneeded Columns\nrems <- !names(windows) %in% c(\"Fexwn1ag\",\"Fexwn2ag\",\"Fexwn1no\",\"Fexwn2no\")\nwindows <- windows[,rems]\nwindows <- reshape(windows, direction = \"wide\", idvar=\"aacode\", timevar=\"type\")\n\nwindows$`numb.Double-glazed- wood`  <- rem_na_0(windows$`numb.Double-glazed- wood`)  \nwindows$`age.Double-glazed- wood` <- rem_na_0(windows$`age.Double-glazed- wood`)\nwindows$`numb.Double-glazed- UPVC` <- rem_na_0(windows$`numb.Double-glazed- UPVC`)\nwindows$`age.Double-glazed- UPVC` <- rem_na_0(windows$`age.Double-glazed- UPVC`)\nwindows$`numb.Single-glazed- UPVC` <- rem_na_0(windows$`numb.Single-glazed- UPVC`)\nwindows$`age.Single-glazed- UPVC` <- rem_na_0(windows$`age.Single-glazed- UPVC`)\nwindows$`numb.Single-glazed- wood casement` <- rem_na_0(windows$`numb.Single-glazed- wood casement`)\nwindows$`age.Single-glazed- wood casement`  <- rem_na_0(windows$`age.Single-glazed- wood casement`)\nwindows$`numb.Double-glazed- metal`  <- rem_na_0(windows$`numb.Double-glazed- metal`)\nwindows$`age.Double-glazed- metal`  <- rem_na_0(windows$`age.Double-glazed- metal`)\nwindows$`numb.Single-glazed- wood sash` <- rem_na_0(windows$`numb.Single-glazed- wood sash`)\nwindows$`age.Single-glazed- wood sash` <- rem_na_0(windows$`age.Single-glazed- wood sash`)\nwindows$`numb.Single-glazed- metal` <- rem_na_0(windows$`numb.Single-glazed- metal`)\nwindows$`age.Single-glazed- metal` <- rem_na_0(windows$`age.Single-glazed- metal`)\n\nwindows$dblglaze <- windows$`numb.Double-glazed- wood` + windows$`numb.Double-glazed- UPVC` + windows$`numb.Double-glazed- metal`\nwindows$dblglazeage <- pmax(windows$`age.Double-glazed- wood`,windows$`age.Double-glazed- UPVC`,windows$`age.Double-glazed- metal`)\nwindows$sngglaze <- windows$`numb.Single-glazed- UPVC` + windows$`numb.Single-glazed- wood casement` + windows$`numb.Single-glazed- wood sash` + windows$`numb.Single-glazed- metal`\nwindows$sngglazeage <- pmax(windows$`age.Single-glazed- UPVC`,windows$`age.Single-glazed- wood casement`,windows$`age.Single-glazed- wood sash`,windows$`age.Single-glazed- metal`)\n\n#Remove Unneeded Columns\nwindows <- windows[,c(\"aacode\",\"dblglaze\",\"dblglazeage\",\"sngglaze\",\"sngglazeage\")]\n\n#####################################################################\n#Join back into a master table\n###################################################################\n\nremove(combined)\n\ncombined <- left_join(context,shape, by = \"aacode\")\ncombined <- left_join(combined,walls, by = \"aacode\")\ncombined <- left_join(combined,roof, by = \"aacode\")\ncombined <- left_join(combined,windows, by = \"aacode\")\ncombined <- left_join(combined,doors, by = \"aacode\")\ncombined <- left_join(combined,energy, by = \"aacode\")\n\n\n\ntest <- combined[,c(\"GorEHCS\",\"rumorph\",\"rucombin\",    \n\"arnatx\",\"floor5x\",     \"storeyx\",     \"basement\",    \"type\",        \"age\",         \"typewstr2\",  \n\"constx\",\"typewfin\",    \"wallinsy\",    \"wallcavy\",    \"typerstr\",    \"Flitypes\",    \"Fliinsul\",   \n\"Finintyp\",    \"Flithick\",    \"felroofp\",    \"attic\",       \"PV\",          \"Solar\",       \"SolarSuit\",  \n\"dblglaze\",    \"dblglazeage\", \"sngglaze\",    \"sngglazeage\", \"doornumb\",    \"doorage\",     \"Finchtyp\",   \n\"Findisty\",    \"mainfuel\",    \"Finmhboi\",    \"Finchbag\",    \"heatsec\",     \"sysage\",      \"watersys\",   \n\"Finohphs\",    \"Finwheat\",    \"Finwhoty\",    \"Finwhoag\",    \"Finwhlty\",    \"Finwhsiz\",    \"Finwhins\",   \n\"Finwhmms\",    \"control\",     \"radcontrol\",  \"tank\",        \"immersage\",   \"instant\"  )]\n#uni <- unique(test)\n#Count the uniqes\n#uni <- as.data.frame(table(test))\nuni <- dplyr::count(test, vars = c(\"GorEHCS\",\"rumorph\",\"rucombin\",    \n                                   \"arnatx\",\"floor5x\",     \"storeyx\",     \"basement\",    \"type\",        \"age\",         \"typewstr2\",  \n                                   \"constx\",\"typewfin\",    \"wallinsy\",    \"wallcavy\",    \"typerstr\",    \"Flitypes\",    \"Fliinsul\",   \n                                   \"Finintyp\",    \"Flithick\",    \"felroofp\",    \"attic\",       \"PV\",          \"Solar\",       \"SolarSuit\",  \n                                   \"dblglaze\",    \"dblglazeage\", \"sngglaze\",    \"sngglazeage\", \"doornumb\",    \"doorage\",     \"Finchtyp\",   \n                                   \"Findisty\",    \"mainfuel\",    \"Finmhboi\",    \"Finchbag\",    \"heatsec\",     \"sysage\",      \"watersys\",   \n                                   \"Finohphs\",    \"Finwheat\",    \"Finwhoty\",    \"Finwhoag\",    \"Finwhlty\",    \"Finwhsiz\",    \"Finwhins\",   \n                                   \"Finwhmms\",    \"control\",     \"radcontrol\",  \"tank\",        \"immersage\",   \"instant\"  ))\n\n\nuni$count <- NA\nfor(p in 1:nrow(uni)){\n  uni$count[p] <- nrow(test[test$Finchtyp == uni$Finchtyp[p] & \n                             test$watersys == uni$watersys[p],])\n}\nsum(uni$count)",
    "created" : 1488380178889.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4241896488",
    "id" : "E78FD461",
    "lastKnownWriteTime" : 1489512002,
    "path" : "C:/Users/earmmor/Git/glider/Glider/code/ehs2rds_2009.R",
    "project_path" : "code/ehs2rds_2009.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}